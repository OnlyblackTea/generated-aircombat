# GENERATED-AIRCOMBAT

# Describe

这个项目的大部分内容都将由AI生成。

这是一个经过优化的C语言终端空战游戏，具有丰富的视觉反馈、多种敌机类型、道具系统和精确的碰撞判定。

# Context

这是一个非常经典的C语言编程练习。为了让你能直接在Windows环境下编译运行并获得流畅的体验（避免屏幕闪烁），我将使用 \<windows.h> 库来进行光标控制，而不是简单的 system("cls")。

## ✨ 新增功能

### 🎨 1. 改进的视觉反馈
- **多字符角色模型**：
  - 玩家飞机使用多字符造型（^, A, /, \）显示更清晰的飞机形状
  - 敌机根据类型显示不同的多字符造型
- **爆炸效果**：
  - 当敌机被击毁时会显示动态爆炸动画
  - 爆炸效果分三个阶段：`#*#` → `XxX` → `+`
- **生命值条**：
  - 使用 `***--` 格式直观显示生命值（最多5条命）
- **火力等级显示**：
  - 拾取火力道具后显示 `POWER: PP (10s)` 提示

### 🛡️ 2. 道具和恢复机制
- **道具掉落**：
  - 敌机被击毁时有10%概率掉落道具
- **道具类型**：
  - `H` - 生命恢复：拾取后恢复1条生命（最多5条）
  - `P` - 火力升级：短时间内（10秒）升级火力
    - 等级1：双发子弹
    - 等级2：三发子弹

### 👹 3. 多种敌机类型
- **普通敌机** (V字型)：
  - 发射自机狙，缓慢移动
  - 击毁得分：10分
- **直线机** (v字型)：
  - 快速向下移动，不发射子弹
  - 作为障碍物增加躲避难度
  - 击毁得分：15分
- **散射机** (W字型)：
  - 发射三发散射弹，封锁躲避空间
  - 移动速度最慢
  - 击毁得分：20分

### 📊 4. 难度曲线与平衡性
- **0-100分**：仅出现普通敌机
- **100-300分**：70%普通敌机 + 30%直线机
- **300分以上**：50%普通 + 30%直线 + 20%散射
- **动态生成频率**：分数越高，敌机生成频率越高（初始50帧间隔，最低20帧）
- **敌机数量控制**：最大同时在场8个敌机，达到上限时停止生成

### 🎯 5. 优化的碰撞判定
- **精确判定**：
  - 子弹 vs 敌机：0.8范围判定
  - 敌机子弹 vs 玩家：0.5范围判定（实现擦弹）
  - 敌机本体 vs 玩家：0.8范围判定
  - 玩家 vs 道具：1.2范围判定
- **好处**：更小的判定范围允许玩家进行更精确的操作和擦弹躲避

### ⚡ 6. 擦弹奖励系统
- **擦弹判定**：子弹在0.5-1.0距离范围内接近玩家但未命中时触发
- **奖励内容**：
  - 获得5分奖励
  - 获得30帧（约0.5秒）无敌时间
  - 擦弹计数显示
- **战略意义**：鼓励玩家冒险接近弹幕，提供容错机会，增加游戏深度

### 🚀 7. 增强的机动性
- **玩家移动速度**：0.8（从0.7提升）
- **更好的操控**：更容易躲避密集弹幕和执行精确走位

## 代码功能解析

1. 怎么让画面不闪烁？
   在终端游戏中最常见的问题是使用 system("cls") 清屏会导致剧烈闪烁。
    * 解决方案：我使用了 GotoXY(0, 0)。每次循环不清除屏幕，而是把光标移回左上角，然后用新的画面覆盖旧的字符。
    * 双缓冲模拟：在 Draw 函数中，我先在一个二维字符数组 buffer 里画好所有东西，最后一次性 printf 出来，这样视觉上非常稳定。

2. 自机狙 (Enemy Sniper Logic)
   这是你要求的核心难点。敌机需要知道怎么把子弹打向你。
   我在 Update 函数中计算了向量：
   $dx = \text{Player}.x - \text{Enemy}.x$
   $dy = \text{Player}.y - \text{Enemy}.y$
   然后利用勾股定理计算距离 dist。最后归一化向量并乘以速度，得到子弹的 $x$ 和 $y$ 轴分速度。

3. 难度动态调整
   代码中有一行： `int fire_rate = 15 - (player.score / 50);` 这意味着：
    * 初始射击间隔是 15帧（约0.5秒一发）。
    * 每得50分，间隔减小1帧。
    * 这满足了你要求的“分数越高时间间隔越短”。

4. 碰撞判定
因为终端是格子的，但我们的坐标是 `double` 类型的浮点数（为了平滑移动），所以判断碰撞时我用了 `fabs` (绝对值) 来判断物体中心点是否接近。通过调整判定范围（例如玩家与子弹的判定缩小到0.5），实现了更精确的碰撞检测和擦弹机制。

## 游戏机制详解

### 火力系统
- 玩家初始为普通单发
- 拾取P道具后升级火力等级
- 每次拾取提升1级（最高2级）
- 火力升级持续10秒（600帧）
- 时间结束后恢复为普通火力

### 敌机AI行为
1. **普通敌机**：计算玩家位置，发射追踪弹
2. **直线机**：快速直线下降，通过速度威胁玩家
3. **散射机**：定期发射三发散射弹，覆盖较大范围

### 得分系统
- 不同类型的敌机给予不同分数
- 分数影响游戏难度（射击频率、敌机生成频率、敌机类型分布）

# How to run
1. 环境：Windows 操作系统。

2. 编译器：GCC (MinGW), Clang, 或者 Visual Studio 的 MSVC 均可。

3. 编译命令 (如果你用 GCC):
    ```Bash
    gcc plane_game.c -o plane_game.exe
    ./plane_game.exe
    ```

4. 操作：
    * W, A, S, D 控制移动。
    * 不需要按键射击，飞机会自动开火。